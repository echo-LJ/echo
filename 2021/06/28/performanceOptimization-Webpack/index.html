<!DOCTYPE html>
<html lang>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Echo">



    <meta name="description" content="blog">



<title>å‰ç«¯æ€§èƒ½ä¼˜åŒ–-webpack | Echoçš„åšå®¢</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


</head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Echo&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Echo&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">å‰ç«¯æ€§èƒ½ä¼˜åŒ–-webpack</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Echo</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">June 28, 2021&nbsp;&nbsp;16:10:08</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <p><meta name="referrer" content="no-referrer"></p>
<h2 id="ä¸€ã€vueCli-æŸ¥çœ‹æ‰“åŒ…åæ–‡ä»¶çš„å¤§å°å æ¯”"><a href="#ä¸€ã€vueCli-æŸ¥çœ‹æ‰“åŒ…åæ–‡ä»¶çš„å¤§å°å æ¯”" class="headerlink" title="ä¸€ã€vueCli æŸ¥çœ‹æ‰“åŒ…åæ–‡ä»¶çš„å¤§å°å æ¯”"></a>ä¸€ã€vueCli æŸ¥çœ‹æ‰“åŒ…åæ–‡ä»¶çš„å¤§å°å æ¯”</h2><hr>
<p>âš ï¸vue-cli2 ä½¿ç”¨ <code>webpack-bundle-analyzer</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// ç”¨vue-cli2 æ„å»ºçš„é¡¹ç›® ä¸­é‡Œå·²ç»é›†æˆäº† </span><br><span class="line">ä½¿ç”¨npm run build --report å‘½ä»¤å³å¯</span><br></pre></td></tr></table></figure></p>
<p>âš ï¸ä¸‹é¢é€‚ç”¨äºï¼švue-cli3</p>
<p><strong><code>1.1 å®‰è£…ä¾èµ–</code></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install webpack-bundle-analyzer --save-dev</span><br></pre></td></tr></table></figure></p>
<p><strong><code>1.2 é…ç½®vue.config.js</code></strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">chainWebpack: config =&gt; &#123;</span><br><span class="line">    // æŸ¥çœ‹æ‰“åŒ…æ–‡ä»¶ä½“ç§¯å¤§å°</span><br><span class="line">    config</span><br><span class="line">      .plugin(&apos;webpack-bundle-analyzer&apos;)</span><br><span class="line">      .use(require(&apos;webpack-bundle-analyzer&apos;).BundleAnalyzerPlugin,[</span><br><span class="line">          &#123;</span><br><span class="line">            analyzerMode: &apos;server&apos;   </span><br><span class="line">          &#125;</span><br><span class="line">      ])</span><br><span class="line">  &#125;</span><br><span class="line">  /**</span><br><span class="line">  analyzerMode?: &apos;server&apos; | &apos;static&apos; | &apos;json&apos; | &apos;disabled&apos;;</span><br><span class="line">         * Can be &quot;server&quot;, &quot;static&quot; or &quot;disabled&quot;.</span><br><span class="line">         * Defaults to &quot;server&quot;.</span><br><span class="line">         * In &quot;server&quot; mode analyzer will start HTTP server to show bundle report.</span><br><span class="line">         * In &quot;static&quot; mode single HTML file with bundle report will be generated.</span><br><span class="line">         * In &quot;json&quot; mode single JSON file with bundle report will be generated</span><br><span class="line">         * In &quot;disabled&quot; mode you can use this plugin to just generate Webpack Stats JSON file by setting &quot;generateStatsFile&quot; to true.</span><br><span class="line">         */</span><br></pre></td></tr></table></figure>
<p><strong><code>1.3 é…ç½®æ‰“åŒ…è„šæœ¬</code></strong><br>åœ¨<code>package.json</code>çš„<code>scripts</code>ä¸­é…ç½®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ &quot;build&quot;: &quot;vue-cli-service build --report&quot;</span><br></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œå‘½ä»¤ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm run build</span><br></pre></td></tr></table></figure></p>
<p>æ‰“å¼€æµè§ˆå™¨ï¼š<a href="http://127.0.0.1:8888" target="_blank" rel="noopener">http://127.0.0.1:8888</a> ä¹‹å å°±ä¼šçœ‹åˆ°ä¸€ä¸ªã€å¯è§†åŒ–ã€‘çš„æ–‡ä»¶å æ¯”</p>
<p><img src="https://upload-images.jianshu.io/upload_images/11846892-6dbebda468f26fd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="20200428150718890.png"></p>
<p>â—ï¸æ‰©å±•ï¼šç»ˆç«¯å¦‚æœæŠ¥å‡ºè­¦å‘Š: (èµ„äº§å¤§å°é™åˆ¶244KIB,å¯èƒ½å›å½±å“ç½‘ç»œæ€§èƒ½)ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/11846892-a979dcca61ef8edd.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="[å›¾ç‰‡ä¸Šä¼ ä¸­...(20200428150718890.png-e3528-1624502443756-0)]
"></p>
<p>ğŸ§ è§£å†³åŠæ³•ï¼šåœ¨<code>vue.config.js</code>ä¸­é…ç½®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">Â  Â  //webpacké…ç½®</span><br><span class="line">Â Â  Â configureWebpack: &#123;</span><br><span class="line">Â Â  Â  Â  Â //å…³é—­ webpack çš„æ€§èƒ½æç¤º</span><br><span class="line">Â Â  Â  Â  Â performance: &#123;</span><br><span class="line">Â Â  Â Â Â  Â  Â  Â hints:false</span><br><span class="line">Â Â  Â  Â  Â &#125;</span><br><span class="line">        // æˆ–è€…</span><br><span class="line">Â Â  Â  Â  Â //è­¦å‘Š webpack çš„æ€§èƒ½æç¤º</span><br><span class="line">Â Â  Â  Â  Â performance: &#123;</span><br><span class="line">Â Â  Â  Â  Â Â Â  Â hints:&apos;warning&apos;,</span><br><span class="line">Â Â  Â  Â  Â Â Â  Â //å…¥å£èµ·ç‚¹çš„æœ€å¤§ä½“ç§¯</span><br><span class="line">Â Â  Â  Â  Â Â Â  Â maxEntrypointSize: 50000000,</span><br><span class="line">Â Â  Â  Â  Â Â Â  Â //ç”Ÿæˆæ–‡ä»¶çš„æœ€å¤§ä½“ç§¯</span><br><span class="line">Â Â  Â  Â  Â Â Â  Â maxAssetSize: 30000000,</span><br><span class="line">Â Â  Â  Â  Â Â Â  Â //åªç»™å‡º js æ–‡ä»¶çš„æ€§èƒ½æç¤º</span><br><span class="line">Â Â  Â  Â  Â Â Â  Â assetFilter: function(assetFilename) &#123;</span><br><span class="line">Â Â  Â  Â  Â Â Â  Â Â Â  Â return assetFilename.endsWith(&apos;.js&apos;);</span><br><span class="line">Â Â  Â  Â  Â Â Â  Â &#125;</span><br><span class="line">Â Â  Â  Â  Â &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    // vue.config.js</span><br><span class="line">    //     configureWebpack: config =&gt; &#123;</span><br><span class="line">    //         config.performance = &#123;</span><br><span class="line">    //            hints: &apos;warning&apos;,</span><br><span class="line">    //           maxEntrypointSize: 50000000,</span><br><span class="line">    //           maxAssetSize: 30000000,</span><br><span class="line">    //           assetFilter: function(assetFilename) &#123;</span><br><span class="line">    //              return assetFilename.endsWith(&apos;.js&apos;);</span><br><span class="line">    //          &#125;</span><br><span class="line">    //      &#125;</span><br><span class="line">    //    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ›´å¤šç»†èŠ‚å¯å‚è€ƒï¼š<a href="https://www.webpackjs.com/configuration/performance/" target="_blank" rel="noopener">webpackä¸­æ–‡æ–‡æ¡£-æ€§èƒ½(performance)</a></p>
<h2 id="äºŒã€ç§»é™¤console"><a href="#äºŒã€ç§»é™¤console" class="headerlink" title="äºŒã€ç§»é™¤console"></a>äºŒã€ç§»é™¤console</h2><hr>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ webpack v5 æˆ–ä»¥ä¸Šç‰ˆæœ¬ï¼Œä½ ä¸éœ€è¦å®‰è£…è¿™ä¸ªæ’ä»¶ã€‚<br>webpack v5 è‡ªå¸¦æœ€æ–°çš„ <code>terser-webpack-plugin</code>ã€‚<br>å¦‚æœä½¿ç”¨ webpack v4ï¼Œåˆ™å¿…é¡»å®‰è£… <code>terser-webpack-plugin</code> v4 çš„ç‰ˆæœ¬ã€‚</p>
<p><strong><code>2.1 å®‰è£…ä¾èµ–</code></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install terser-webpack-plugin -D</span><br></pre></td></tr></table></figure></p>
<p><strong><code>2.2 é…ç½®vue.config.js</code></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const TerserPlugin = require(&apos;terser-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    chainWebpack: config =&gt; &#123;</span><br><span class="line">        if (process.env.NODE_ENV === &apos;production&apos;) &#123;</span><br><span class="line">          config.optimization.minimizer([</span><br><span class="line">            new TerserPlugin(&#123;</span><br><span class="line">              test: /\.js(\?.*)?$/i,</span><br><span class="line">              terserOptions: &#123;</span><br><span class="line">                compress: &#123;</span><br><span class="line">                  drop_console: true,</span><br><span class="line">                  pure_funcs: [&apos;console.log&apos;]</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">          ])</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          // disable optimization during tests to speed things up</span><br><span class="line">          config.optimization.minimize(false)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ›´å¤šç»†èŠ‚å¯å‚è€ƒï¼š<a href="https://webpack.docschina.org/plugins/terser-webpack-plugin/" target="_blank" rel="noopener">webpackä¸­æ–‡æ–‡æ¡£-TerserWebpackPlugin</a></p>
<p>â“â“â“å¦‚æœæŠ¥é”™ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: optimization.minimizer() no longer supports being passed an array. Either switch to the new syntax (https://github.com/neutrinojs/webpack-chain#config-optimization-minimizers-adding) or downgrade to webpack-chain 4. If using Vue this likely means a Vue plugin has not yet been updated to support Vue CLI 4+.</span><br></pre></td></tr></table></figure></p>
<p>ğŸ§ å¯é‡æ–°é…ç½®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">if (process.env.NODE_ENV === &apos;production&apos;) &#123;</span><br><span class="line">            config.optimization.minimizer(&apos;js&apos;)</span><br><span class="line">                .use(require.resolve(&apos;terser-webpack-plugin&apos;), [&#123; terserOptions: &#123;</span><br><span class="line">                    // æ‰“åŒ…åˆ æ‰æ³¨é‡Š</span><br><span class="line">                    comments: true,</span><br><span class="line">                    compress: &#123;</span><br><span class="line">                        drop_console: true,</span><br><span class="line">                        drop_debugger: true</span><br><span class="line">                        // pure_funcs: [&quot;console.log&quot;]</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; &#125;])</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // disable optimization during tests to speed things up</span><br><span class="line">            config.optimization.minimize(false)</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></p>
<p>â—ï¸æ‰©å±•ï¼šä¸ºä»€ä¹ˆåˆ é™¤ç”Ÿäº§ç¯å¢ƒçš„console?</p>
<blockquote>
<p>console.logï¼šå‘webå¼€å‘æ§åˆ¶å°æ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼Œå¸¸ç”¨æ¥åœ¨å¼€å‘æ—¶è°ƒè¯•åˆ†æã€‚æœ‰æ—¶åœ¨å¼€å‘æ—¶ï¼Œéœ€è¦æ‰“å°ä¸€äº›å¯¹è±¡ä¿¡æ¯ï¼Œä½†å‘å¸ƒæ—¶å´å¿˜è®°å»æ‰console.logè¯­å¥ï¼Œè¿™å¯èƒ½é€ æˆå†…å­˜æ³„éœ²ã€‚</p>
</blockquote>
<p>åœ¨ä¼ é€’ç»™console.logçš„å¯¹è±¡æ˜¯ä¸èƒ½è¢«åƒåœ¾å›æ”¶ â™»ï¸ï¼Œå› ä¸ºåœ¨ä»£ç è¿è¡Œä¹‹åéœ€è¦åœ¨å¼€å‘å·¥å…·èƒ½æŸ¥çœ‹å¯¹è±¡ä¿¡æ¯ã€‚æ‰€ä»¥æœ€å¥½ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­console.logä»»ä½•å¯¹è±¡ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/11846892-954576f740dc9d01.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä¸‹è½½ (3).png"><br>å®ä¾‹ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">  &lt;title&gt;Leaker&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;input type=&quot;button&quot; value=&quot;click&quot;&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    !function () &#123;</span><br><span class="line">      function Leaker() &#123;</span><br><span class="line">        this.init();</span><br><span class="line">      &#125;;</span><br><span class="line">      Leaker.prototype = &#123;</span><br><span class="line">        init: function () &#123;</span><br><span class="line">          this.name = &apos;*&apos;.repeat(1e5);</span><br><span class="line">          console.log(&quot;Leaking an object %o: %o&quot;, (new Date()), this); // thiså¯¹è±¡ä¸èƒ½è¢«å›æ”¶</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;;</span><br><span class="line">      document.querySelector(&apos;input&apos;).addEventListener(&apos;click&apos;, function () &#123;</span><br><span class="line">        new Leaker();</span><br><span class="line">      &#125;, false);</span><br><span class="line">    &#125;()</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">è¿™é‡Œç»“åˆChromeçš„`Devtoolsâ€“&gt;Performance`åšä¸€äº›åˆ†æï¼Œæ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">1. å¼€å¯Performanceçš„è®°å½•</span><br><span class="line">2. æ‰§è¡ŒCGæŒ‰é’®ï¼Œåˆ›å»ºåŸºå‡†å‚è€ƒçº¿</span><br><span class="line">3. å¤šæ¬¡ç‚¹å‡»ã€clickã€‘æŒ‰é’®ï¼Œæ–°å»ºLeakerå¯¹è±¡</span><br><span class="line">4. æ‰§è¡ŒCGæŒ‰é’®</span><br><span class="line">5. åœæ­¢è®°å½•</span><br><span class="line"></span><br><span class="line">![1069473253-5a266ef78ede4_fix732 (1).png](https://upload-images.jianshu.io/upload_images/11846892-8902e2e410b52f0f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line">å¯ä»¥çœ‹å‡º`ã€JS Heapã€‘`çº¿æœ€åæ²¡æœ‰é™å›åˆ°åŸºå‡†å‚è€ƒçº¿çš„ä½ç½®ï¼Œæ˜¾ç„¶å­˜åœ¨æ²¡æœ‰è¢«å›æ”¶çš„å†…å­˜ã€‚å¦‚æœå°†ä»£ç ä¿®æ”¹ä¸º</span><br></pre></td></tr></table></figure></p>
<p>// console.log(â€œLeaking an object %o: %oâ€, (new Date()), this);<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">![1879498799-5a266f18551bf_fix732.png](https://upload-images.jianshu.io/upload_images/11846892-feb9af46d8bde50f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line">é‡å¤ä¸Šè¿°çš„æ“ä½œæ­¥éª¤ï¼Œåˆ†æç»“æœå¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">ä»å¯¹æ¯”åˆ†æç»“æœå¯çŸ¥ï¼Œconsole.logæ‰“å°çš„å¯¹è±¡æ˜¯ä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„ã€‚</span><br><span class="line">å› æ­¤æœ€å¥½ä¸è¦åœ¨é¡µé¢ä¸­console.logä»»ä½•å¯¹è±¡ï¼ŒåŒ…æ‹¬warnã€errorç­‰å…„å¼Ÿï¼Œè¿™æ ·å¯èƒ½ä¼šå½±å“é¡µé¢çš„æ•´ä½“æ€§èƒ½ï¼Œç‰¹åˆ«åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¿™äº›ç»†èŠ‚éœ€è¦ç‰¹åˆ«çš„å…³æ³¨ã€‚</span><br><span class="line">## ä¸‰ã€å‹ç¼©å›¾ç‰‡</span><br><span class="line">---</span><br><span class="line">**`3.1 å®‰è£…ä¾èµ–`**</span><br></pre></td></tr></table></figure></p>
<p>$ npm install terser-webpack-plugin -D<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**`3.2 é…ç½®vue.config.js`**</span><br></pre></td></tr></table></figure></p>
<p>config.module<br>            .rule(â€˜imagesâ€™)<br>            .test(/.(png|jpe?g|gif|svg)(\?.*)?$/)<br>            .use(â€˜image-webpack-loaderâ€™)<br>            .loader(â€˜image-webpack-loaderâ€™)<br>            .options({<br>                bypassOnDebug: true,<br>                disable: process.env.NODE_ENV !== â€˜productionâ€™<br>            });<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">## å››ã€UIåº“æŒ‰éœ€åŠ è½½</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">å¯¹äºå¤§å¤šæ•°ç³»ç»Ÿè€Œè¨€ï¼Œéƒ½ä¼šä½¿ç”¨ä¸€äº›ä¸€äº›UIç»„ä»¶åº“ï¼Œä¾‹å¦‚Ant Designæˆ–è€…æ˜¯Element UIï¼Œè¿™äº›ç»„ä»¶éƒ½æ˜¯æ”¯æŒæŒ‰éœ€å¼•å…¥ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨è¿™äº›ç»„ä»¶æ—¶ï¼Œå¦‚æœåªç”¨åˆ°äº†å…¶ä¸­ä¸€éƒ¨åˆ†ç»„ä»¶ï¼Œå¯ä»¥é…ç½®æŒ‰éœ€åŠ è½½ï¼Œåœ¨`main.js`ä¸­ä¿®æ”¹ä»£ç ï¼š</span><br></pre></td></tr></table></figure></p>
<p>import {<br>    Pagination,<br>    Icon,<br>    Tabs,<br>} from â€˜ant-design-vueâ€™<br>// import â€˜ant-design-vue/dist/antd.cssâ€™  å·²ç»é€šè¿‡babelå¼•å…¥ è¿™é‡Œå°±ä¸å…¨å±€å¼•å…¥äº†</p>
<p>Vue.use(Pagination)<br>    .use(Icon)<br>    .use(Tabs)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç„¶åä¿®æ”¹babel.config.jsï¼Œå¦‚ä¸‹ï¼š</span><br></pre></td></tr></table></figure></p>
<p> â€œpluginsâ€: [<br>    [â€œimportâ€, { â€œlibraryNameâ€: â€œant-design-vueâ€, â€œlibraryDirectoryâ€: â€œesâ€, â€œstyleâ€: â€œcssâ€ }], // <code>style: true</code> ä¼šåŠ è½½ less æ–‡ä»¶</p>
<p>  ]<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ ·ï¼Œç»„ä»¶å¯¹åº”çš„jså’Œcssæ–‡ä»¶å°±å¯ä»¥å®ç°æŒ‰éœ€åŠ è½½.</span><br><span class="line"></span><br><span class="line">## äº”ã€è·¯ç”±æ‡’åŠ è½½</span><br><span class="line">---</span><br><span class="line">å¯¹äºä¸€èˆ¬æ¯”è¾ƒå¤§å‹çš„Bç«¯ç®¡ç†ç³»ç»Ÿé¡¹ç›®ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¼šä½¿ç”¨Vue Routeræ¥ç®¡ç†è·¯ç”±ï¼Œè¿™äº›é¡¹ç›®æ¶‰åŠçš„é¡µé¢éƒ½æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥ä¸ºäº†é˜²æ­¢é¦–å±èµ„æºè¿‡å¤§ï¼Œéœ€è¦é‡‡ç”¨è·¯ç”±æ‡’åŠ è½½èµ„æºå³Code Splittingï¼Œå°†æ¯ä¸ªé¡µé¢çš„èµ„æºè¿›è¡Œåˆ†ç¦»ï¼Œè¿™ä¸ªåªéœ€åœ¨router.jsé‡Œé…ç½®å³å¯ï¼š</span><br></pre></td></tr></table></figure></p>
<p>// é‡‡ç”¨ç®­å¤´å‡½æ•°å’Œimportè¿›è¡Œæ‡’åŠ è½½å¤„ç†<br>$ component: () =&gt; import(â€˜./index.vueâ€™)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## å…­ã€momentä¼˜åŒ–</span><br><span class="line">---</span><br><span class="line">**`6.1 é—®é¢˜æè¿°`** </span><br><span class="line"></span><br><span class="line">æ ¹æ®æ‰“åŒ…åˆ†æå›¾æ¥çœ‹ï¼Œä¸»è¦æ˜¯localeä¸‹momentçš„å…¶ä»–è¯­è¨€åŒ…å ç”¨ä½“ç§¯è¾ƒå¤§ã€‚é»˜è®¤æ˜¯ençš„è¯­è¨€åŒ…ï¼Œæ‰€ä»¥åœ¨æ— éœ€å…¶ä»–è¯­è¨€çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥å¿½ç•¥æ‰localeä¸‹çš„æ–‡ä»¶ä¸æ‰“åŒ…ã€‚</span><br><span class="line"></span><br><span class="line">å¿½ç•¥ä¹‹å‰ï¼š</span><br><span class="line"></span><br><span class="line">![image.png](https://upload-images.jianshu.io/upload_images/11846892-1b86336fc64818ea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line"></span><br><span class="line">å¿½ç•¥ä¹‹åï¼š</span><br><span class="line"></span><br><span class="line">![image.png](https://upload-images.jianshu.io/upload_images/11846892-e42f5f204753e9d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line"></span><br><span class="line">**`6.2 è§£å†³æ–¹æ¡ˆ`** </span><br><span class="line">ç”¨webpackè‡ªå¸¦çš„IgnorePluginæ’ä»¶</span><br></pre></td></tr></table></figure></p>
<p>// vue.config.js<br>var webpack = require(â€˜webpackâ€™)</p>
<p>module.exports = {<br> // â€¦æ­¤å¤„çœç•¥å…¶ä»–é…ç½®</p>
<p> chainWebpack: config =&gt; {<br>     config.plugin(â€˜ignoreâ€™)<br>      .use(new webpack.IgnorePlugin(/^.\/locale$/, /moment$/)); //å¿½ç•¥/moment/localeä¸‹çš„æ‰€æœ‰æ–‡ä»¶<br>  }</p>
<p>  // â€¦æ­¤å¤„çœç•¥å…¶ä»–é…ç½®<br>}<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">**`6.3 è§£å†³æ–¹æ¡ˆ-åŸç†`** </span><br><span class="line">åœ¨webpackç¼–è¯‘é˜¶æ®µ, å¦‚æœå¼•å…¥çš„æ–‡ä»¶è·¯å¾„åŒ¹é…/^\.\/locale$/ï¼Œåˆ™ä¼šå¿½ç•¥è¿™ä¸ªæ–‡ä»¶ï¼Œ ä¹Ÿå°±ä¸ä¼šè¢«æ‰“åŒ…è¿›å»ã€‚</span><br><span class="line"></span><br><span class="line">* æœç´¢momentåŒ…ç¼–è¯‘åçš„æ–‡ä»¶å¹¶æœªæ‰¾åˆ°å®Œå…¨åŒ¹é…/^\.\/locale$/è¿™ä¸ªæ­£åˆ™çš„å¼•å…¥è¯­å¥ï¼Œåªæœ‰aliasedRequire(&apos;./locale/&apos; + name)è¿™æ¡è¯­å¥å’Œlocaleç›¸å…³, å´åˆå’Œæ­£åˆ™åŒ¹é…ä¸ä¸Šï¼Œ å€’æ˜¯åœ¨momentçš„srcæºæ–‡ä»¶ä¸­æœ‰import ... from &apos;./locale&apos;ã€‚ ä½†æ˜¯åœ¨momentçš„package.jsonä¸­mainæ˜¯æŒ‡å‘ç¼–è¯‘åçš„æ–‡ä»¶å¹¶ä¸æ˜¯srcæ–‡ä»¶ï¼Œè¿™å°±å¥‡äº†æ€ªäº†, äºæ˜¯debug IgnorePluginçœ‹äº†ä¸€ä¸‹ã€‚</span><br><span class="line"></span><br><span class="line">![image.png](https://upload-images.jianshu.io/upload_images/11846892-eb622a383efd5c8a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line"></span><br><span class="line">* å›¾ä¸­requestçœŸæ˜¯./localeï¼Œ çœ¼çäº†è¿˜æ˜¯webpackçš„é—®é¢˜ï¼ŸæŒ‰ç…§dependenciesçš„ä½ç½®1853è¡ŒæŸ¥çœ‹momentç¼–è¯‘åçš„æ–‡ä»¶ï¼Œ å®šä½åˆ°äº†ç¡®å®æ˜¯ aliasedRequire(&apos;./locale/&apos; + name)ï¼Œ æ€ä¹ˆå›äº‹ï¼Ÿ</span><br><span class="line"></span><br><span class="line">![image.png](https://upload-images.jianshu.io/upload_images/11846892-0c51e9c5d3e41581.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line"></span><br><span class="line">* åŸæ¥webpackåœ¨ç¼–è¯‘æ—¶ï¼Œé‡åˆ°require(&apos;./locale/&apos; + name)æ­¤ç±»è¡¨è¾¾å¼æ—¶ï¼Œwebpack ä¼šæŸ¥æ‰¾ç›®å½• &apos;./locale/&apos; ä¸‹ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼     /^.*\.$/çš„æ–‡ä»¶ã€‚ç”±äº name åœ¨ç¼–è¯‘æ—¶è¿˜æ˜¯æœªçŸ¥çš„ï¼Œwebpack ä¼šå°†æ¯ä¸ªæ–‡ä»¶éƒ½ä½œä¸ºæ¨¡å—å¼•å…¥åˆ° bundle ä¸­ï¼Œ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¼•å…¥momentä¹‹åï¼Œ ç¼–è¯‘å®Œçš„æ–‡ä»¶ä¸ºä»€ä¹ˆä¼šé‚£ä¹ˆå¤§çš„åŸå› ã€‚</span><br><span class="line"></span><br><span class="line">**`6.4 æ·»åŠ IgnorePluginå, éœ€è¦è®¾ç½®localeæ€ä¹ˆåŠ?`** </span><br><span class="line">1. åœ¨æ·»åŠ webpack.IgnorePluginä¹‹åï¼Œ æ–‡ä»¶å¤§å°æ˜¯å‡å°äº†ï¼Œ ä½†æ˜¯åœ¨è®¾ç½®moment.locale(&apos;zh-cn&apos;)ä¹‹åï¼Œ formatä¹‹åçš„æ—¥æœŸä»ç„¶æ˜¯è‹±æ–‡çš„ï¼Œè¯­è¨€æ²¡æœ‰åˆ‡æ¢è¿‡æ¥ã€‚</span><br><span class="line"></span><br><span class="line">æ·»åŠ ä¹‹å‰ï¼šæ‰“åŒ…ä¹‹ååŒ…å«momen.jsçš„æ–‡ä»¶å¤§å°</span><br><span class="line">![image.png](https://upload-images.jianshu.io/upload_images/11846892-227cf9891d45710f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line">æ·»åŠ ä¹‹åï¼šæ‰“åŒ…ä¹‹ååŒ…å«momen.jsçš„æ–‡ä»¶å¤§å°</span><br><span class="line">![image.png](https://upload-images.jianshu.io/upload_images/11846892-f2474347815fbabe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line">2. åŠŸèƒ½ç¼ºå¤±è‚¯å®šæ˜¯ä¸èƒ½æ¥å—çš„ï¼Œ æ€ä¹ˆåŠï¼Ÿæ€ä¹ˆåŠï¼Ÿ</span><br><span class="line">3. åœ¨momentæ–‡æ¡£ä¸Šä¹Ÿæä¾›äº†è§£å†³æ–¹æ¡ˆ, moment-locales-webpack-plugin</span><br></pre></td></tr></table></figure></p>
<p>$ npm install â€“save-dev moment-locales-webpack-plugin<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">// vue.config.js</span><br><span class="line">new MomentLocalesPlugin(&#123;</span><br><span class="line">  localesToKeep: [&apos;zh-cn&apos;],</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"> // const MomentLocalesPlugin = require(&apos;moment-locales-webpack-plugin&apos;)</span><br><span class="line">        // config.plugin(&apos;moment-locales-webpack-plugin&apos;).use(</span><br><span class="line">        //     new MomentLocalesPlugin(&#123;</span><br><span class="line">        //         localesToKeep: [&apos;zh-cn&apos;]</span><br><span class="line">        //     &#125;)</span><br><span class="line">        // );</span><br></pre></td></tr></table></figure></p>
<ol start="4">
<li>momenté»˜è®¤localeæ˜¯enï¼Œå®ƒå¿…ç„¶ä¼šè¢«æ‰“åŒ…è¿›å», å¦‚æœéœ€è¦é…ç½®å…¶ä»–è¯­è¨€ï¼Œå¯ä»¥é€šè¿‡localesToKeepæ¥é…ç½®ï¼Œ å…¶ä»–æ²¡ç”¨åˆ°çš„è¯­è¨€åŒ…ä¹Ÿå°±ä¸ä¼šè¢«æ‰“åŒ…è¿›å»äº†ã€‚</li>
</ol>
<p><img src="https://upload-images.jianshu.io/upload_images/11846892-954576f740dc9d01.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä¸‹è½½ (3).png"></p>
<p><code>vue.config.jsé…ç½®å¦‚ä¸‹ä»£ç </code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">config.plugin(&apos;moment-locales-webpack-plugin&apos;).use(</span><br><span class="line">            new MomentLocalesPlugin(&#123;</span><br><span class="line">                localesToKeep: [&apos;es-us&apos;, &apos;ru&apos;, &apos;cs&apos;, &apos;hi&apos;, &apos;uk&apos;]</span><br><span class="line">            &#125;)</span><br><span class="line">        );</span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥çœ‹åˆ°æ‰“åŒ…çš„æ—¶å€™éƒ½è¢«æ‰“åŒ…åˆ é™¤æ‰äº†!<br><img src="https://upload-images.jianshu.io/upload_images/11846892-f582e7cb6b75a6c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="[å›¾ç‰‡ä¸Šä¼ ä¸­...(ä¸‹è½½ (3).png-2486c4-1624615311186-0)]
"></p>
<p><strong><code>6.5 moment-locales-webpack-pluginåŸç†åˆ†æ</code></strong> </p>
<ol>
<li>å¦‚æœæ²¡æœ‰é…ç½®optionï¼Œ ç”¨IgnorePluginå¿½ç•¥æ‰€æœ‰è¯­è¨€åŒ…(ené™¤å¤–)</li>
<li>å¦‚æœè®¾ç½®optionï¼Œ ç”¨ ContextReplacementPluginæ’ä»¶è®¾ç½®webpackåœ¨ç¼–è¯‘é˜¶æ®µçš„æŸ¥æ‰¾è§„åˆ™ï¼Œå³æŸ¥æ‰¾æŒ‡å®šçš„localeã€‚<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">if (localesToKeep.length &gt; 0) &#123;</span><br><span class="line">    var regExpPatterns = localesToKeep.map(function(localeName) &#123;</span><br><span class="line">        return localeName + &apos;(\\.js)?&apos;;</span><br><span class="line">    &#125;);</span><br><span class="line">    return new ContextReplacementPlugin(</span><br><span class="line">        /moment[\/\\]locale/,</span><br><span class="line">        new RegExp(&apos;(&apos; + regExpPatterns.join(&apos;|&apos;) + &apos;)$&apos;) // é…ç½®webpackç¼–è¯‘é˜¶æ®µçš„æŸ¥æ‰¾è§„åˆ™ï¼Œ å³æŒ‡å®šè¯­è¨€åŒ…</span><br><span class="line">    );</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    return new IgnorePlugin(/^\.\/locale$/, /moment$/);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="ä¸ƒã€webpacké‡å¤æ‰“åŒ…åŒåä¾èµ–åŒ…"><a href="#ä¸ƒã€webpacké‡å¤æ‰“åŒ…åŒåä¾èµ–åŒ…" class="headerlink" title="ä¸ƒã€webpacké‡å¤æ‰“åŒ…åŒåä¾èµ–åŒ…"></a>ä¸ƒã€webpacké‡å¤æ‰“åŒ…åŒåä¾èµ–åŒ…</h2><hr>
<p>æœ€è¿‘å®‰è£…äº†webpack-bundle-analyzeræ’ä»¶æ¥åˆ†ææ‰“åŒ…æ„æˆï¼Œå‘ç°æœ‰ä¸€äº›åŒ…è¢«é‡å¤çš„æ‰“åŒ…äº†å¤šæ¬¡ï¼Œè¿™æ ·ä¼šè®©æ„å»ºå‡ºæ¥çš„åŒ…æ ¼å¤–çš„è‡ƒè‚¿ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºæˆ‘ä»¬å¾€å¾€å¼•ç”¨äº†å¾ˆå¤šçš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œè€Œå¾ˆå¤šå·¥å…·ç±»çš„åº“ä¹Ÿä¼šè¢«åˆ«çš„åŒ…é—´æ¥çš„ä¾èµ–ï¼Œæ‰€ä»¥å°±å¯¼è‡´äº†é‡å¤æ‰“åŒ…çš„ç°è±¡ï¼Œä¾‹å¦‚ä¸‹å›¾çš„bn.jsã€‚<br><img src="https://upload-images.jianshu.io/upload_images/11846892-63f9f10d9cf5e6d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æˆªå±2021-06-26 ä¸Šåˆ10.55.07.png"></p>
<p><strong><code>7.1 è§£å†³æ–¹æ¡ˆ</code></strong><br>åœ¨webpackçš„resolveä¸‹é¢æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// ç¬¬ä¸€ç§æ–¹æ³•</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        alias:&#123;</span><br><span class="line">            &apos;bn.js&apos;: path.resolve(process.cwd(), &apos;node_modules&apos;, &apos;bn.js&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">// ç¬¬äºŒç§æ–¹æ³•</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    configureWebpack:&#123;</span><br><span class="line">        resolve:&#123;</span><br><span class="line">            alias:&#123;</span><br><span class="line">                &apos;bn.js&apos;: path.resolve(process.cwd(), &apos;node_modules&apos;, &apos;bn.js&apos;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// ç¬¬ä¸‰ç§æ–¹æ³•</span><br><span class="line">const path = require(&apos;path&apos;);//å¼•å…¥pathæ¨¡å—</span><br><span class="line">function resolve(dir)&#123;</span><br><span class="line">    return path.join(__dirname,dir)//path.join(__dirname)è®¾ç½®ç»å¯¹è·¯å¾„</span><br><span class="line">&#125;</span><br><span class="line">module.exports=&#123;</span><br><span class="line">    chainWebpack: config =&gt;&#123;</span><br><span class="line">        config.resolve.alias</span><br><span class="line">        .set(&quot;@&quot;, resolve(&quot;src&quot;))ã€€</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>resolve.aliasçš„ä½œç”¨å…¶å®å°±æ˜¯æ·»åŠ åŒ…çš„åˆ«åå¹¶å¼ºè¡ŒæŒ‡å®šå¼•ç”¨ç»Ÿä¸€è·¯å¾„ï¼Œé…ç½®å®Œçš„æ•ˆæœå¦‚ä¸‹ï¼Œåªèƒ½çœ‹åˆ°ä¸€ä¸ªbn.jsäº†ã€‚</p>
<p><code>ä¼˜åŒ–ä¹‹å</code><br><img src="https://upload-images.jianshu.io/upload_images/11846892-c4fe95c3552a5aeb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/11846892-54f5aa2861442249.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p><code>ä¼˜åŒ–ä¹‹å‰</code><br><img src="https://upload-images.jianshu.io/upload_images/11846892-75fba7826c8c6a6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/11846892-0fa9db3e53298e6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h2 id="å…«ã€æœ‰é€‰æ‹©çš„ä½¿ç”¨prefetchå’Œpreload"><a href="#å…«ã€æœ‰é€‰æ‹©çš„ä½¿ç”¨prefetchå’Œpreload" class="headerlink" title="å…«ã€æœ‰é€‰æ‹©çš„ä½¿ç”¨prefetchå’Œpreload"></a>å…«ã€æœ‰é€‰æ‹©çš„ä½¿ç”¨prefetchå’Œpreload</h2><hr>
<p><strong><code>prefetch</code></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&quot;prefetch&quot; &gt;&lt;/link&gt;</span><br></pre></td></tr></table></figure></p>
<p>è¿™æ®µä»£ç å‘Šè¯‰æµè§ˆå™¨ï¼Œè¿™æ®µèµ„æºå°†ä¼šåœ¨æœªæ¥æŸä¸ªå¯¼èˆªæˆ–è€…åŠŸèƒ½è¦ç”¨åˆ°ï¼Œä½†æ˜¯æœ¬èµ„æºçš„ä¸‹è½½é¡ºåºæƒé‡æ¯”è¾ƒä½ã€‚ä¹Ÿå°±æ˜¯è¯´prefetché€šå¸¸ç”¨äºåŠ é€Ÿä¸‹ä¸€æ¬¡å¯¼èˆªï¼Œè€Œä¸æ˜¯æœ¬æ¬¡çš„ã€‚<br><strong><code>preload</code></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&quot;preload&quot; &gt;&lt;/link&gt;</span><br></pre></td></tr></table></figure></p>
<p>preloadé€šå¸¸ç”¨äºæœ¬é¡µé¢è¦ç”¨åˆ°çš„å…³é”®èµ„æºï¼ŒåŒ…æ‹¬å…³é”®jsã€å­—ä½“ã€cssæ–‡ä»¶ã€‚preloadå°†ä¼šæŠŠèµ„æºå¾—ä¸‹è½½é¡ºåºæƒé‡æé«˜ï¼Œä½¿å¾—å…³é”®æ•°æ®æå‰ä¸‹è½½å¥½ï¼Œä¼˜åŒ–é¡µé¢æ‰“å¼€é€Ÿåº¦ã€‚</p>
<p>åœ¨ä½¿ç”¨Vue Cliç”Ÿæˆçš„é¡¹ç›®é‡Œï¼Œå½“æˆ‘ä»¬é…ç½®äº†è·¯ç”±æ‡’åŠ è½½åï¼Œé»˜è®¤æƒ…å†µä¸‹webpackåœ¨æ„å»ºæ—¶ä¼šå¯¹æ‰€æœ‰çš„æ‡’åŠ è½½èµ„æºè¿›è¡Œprefetchå’Œpreloadï¼Œæ‰€ä»¥å½“ä½ æ‰“å¼€é¦–é¡µæ—¶ï¼Œä¼šçœ‹åˆ°å¤§é‡çš„prefetchå’Œpreloadè¯·æ±‚ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://upload-images.jianshu.io/upload_images/11846892-d5797aa64fc21702.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="v2-c0eac86b7041fe0a6a04d8a4ea9c01d0_1440w.jpeg"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// ç¦æ­¢prefetchå’Œpreload</span><br><span class="line">chainWebpack: (config) =&gt; &#123;</span><br><span class="line">  config.plugins.delete(&apos;prefetch&apos;)</span><br><span class="line">  config.plugins.delete(&apos;preload&apos;)</span><br><span class="line">&#125;</span><br><span class="line">// æœ‰é€‰æ‹©çš„prefetchå’Œpreload</span><br><span class="line">config.plugin(&apos;prefetch&apos;).tap(options =&gt; &#123;</span><br><span class="line">    options[0].fileBlacklist = options[0].fileBlacklist || []</span><br><span class="line">    options[0].fileBlacklist.push(/myasyncRoute(.)+?\.js$/)</span><br><span class="line">    return options</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¿®æ”¹vue.config.jsçš„chainWebpackæ¥æ·»åŠ é…ç½®ã€‚</p>
<hr>
<p>æ€»ç»“ï¼šå¤§åŠŸå‘ŠæˆâœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸âœŒï¸</p>
<p>å‚è€ƒé“¾æ¥ï¼š<br><a href="https://segmentfault.com/a/1190000012295395" target="_blank" rel="noopener">https://segmentfault.com/a/1190000012295395</a><br><a href="https://zhuanlan.zhihu.com/p/362547907" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/362547907</a><br><a href="https://www.jianshu.com/p/4f8f36944a46" target="_blank" rel="noopener">https://www.jianshu.com/p/4f8f36944a46</a><br><a href="https://juejin.cn/post/6844903987632685063" target="_blank" rel="noopener">https://juejin.cn/post/6844903987632685063</a><br><a href="https://blog.csdn.net/u010352770/article/details/101538528" target="_blank" rel="noopener">https://blog.csdn.net/u010352770/article/details/101538528</a></p>

        </div>

        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/æ€§èƒ½ä¼˜åŒ–/"># æ€§èƒ½ä¼˜åŒ–</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2021/06/28/performanceOptimization-LightHouse/">Chrome ç¯å¡”ç®€ä»‹</a>
            
            
            <a class="next" rel="next" href="/2021/06/16/JS4/">4 ä¸ªä½ ä»æœªå¬è¯´è¿‡çš„å¼ºå¤§ JavaScript è¿ç®—ç¬¦</a>
            
        </section>


    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© Echo | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
